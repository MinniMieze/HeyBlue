@startuml  App Installation & User Registration

title
Usecase 1-3
User Registration / App Installation
end title

autonumber

actor Civ as "Civilian\nUser"
actor Off as "Officer\nUser"

box "Hey Blue" #Lightblue
    participant Desktop as "Desktop\nWebside"
    participant Mobile as "Mobile\nApp"

    participant API_Layer as "Hey Blue\nAPI Layer"

    participant ID_DB as "Hey Blue\nIdentity Database"
    participant GOV_DB as "Hey Blue\nGoverment Database"
end box

box "External Services" 
    participant Appstore as "App Stores"
    participant FIS as "Federated Identity Services"
end box

'##### App Installation

opt App installation workflow
Civ --> Civ : Opens Device App Store
Off --> Off : Opens Device App store
 activate Civ
 activate Off
    activate Appstore
    Civ -> Appstore : search App and request for installation
    Appstore -> Civ : install app
    Off -> Appstore : search App and request for installation
    Appstore -> Civ : install app
    deactivate Appstore 
end


'###### User Registration

opt User Registration via App
Civ --> Civ : Opens App
Off --> Off : Opens App
    activate Mobile
    Civ -> Mobile : start user registration
    Off -> Mobile : start user registration
        activate API_Layer 
        Mobile -> API_Layer : user registration service
            activate ID_DB
            API_Layer -> ID_DB : create new account if needed
                activate FIS
                API_Layer -> FIS : check for existing user
                FIS -> API_Layer : response for user request
                deactivate FIS
            ID_DB -> API_Layer : response to user creation
            deactivate ID_DB
        API_Layer -> Mobile : response for \nuser registration process
        deactivate API_Layer
    Mobile -> Civ : end user registration
    Mobile -> Off : end user registration
    deactivate Mobile
end


opt User Registration via Desktop Webside
Civ --> Civ : Opens Webside
Off --> Off : Opens Webside
   activate Desktop
    Civ -> Desktop : start user registration
    Off -> Desktop : start user registration
        activate API_Layer 
        Desktop -> API_Layer : user registration service
            activate ID_DB
            API_Layer -> ID_DB : create new account if needed
                activate FIS
                API_Layer -> FIS : check for existing user
                FIS -> API_Layer : response for user request
                deactivate FIS
            ID_DB -> API_Layer : response to user creation
            deactivate ID_DB
        API_Layer -> Desktop : response for \nuser registration process
        deactivate API_Layer
    Desktop -> Civ : end user registration
    Desktop -> Off : end user registration
    deactivate Desktop
end



'###### missing
' Fill the gov DB or manual check via Admin GUI
' Check Gov User against Gov DB

@enduml 